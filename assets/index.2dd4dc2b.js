import{d as v}from"./create.03b31fc7.js";import{g}from"./elements.2a324d45.js";import{t as l,e as a,i as _}from"./shared.f8da68a0.js";import{V,F as S}from"./validation.7606bf3f.js";import{c as y}from"./relation.9e421618.js";import{n as P}from"./index.0a9349fd.js";function x(t){return["always","normal","never"].includes(t)}const C={value:{type:[Number,Array],default:0},step:{type:[Number,String],default:1},range:{type:Boolean,default:!1},labelVisible:{type:String,default:"normal",validator:x},activeColor:{type:String},trackColor:{type:String},thumbColor:{type:String},labelColor:{type:String},labelTextColor:{type:String},trackHeight:{type:[String,Number]},thumbSize:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},rules:{type:Array}};var z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"var-slider"},[s("div",{ref:"sliderEl",staticClass:"var-slider-block",class:[t.isDisabled?"var-slider__disable":null,t.errorMessage?"var-slider__error":null],style:{height:t.thumbSize===void 0?t.thumbSize:3*t.toNumber(t.thumbSize)+"px",margin:t.thumbSize===void 0?t.thumbSize:"0 "+t.toNumber(t.thumbSize)/2+"px"},on:{click:t.click}},[s("div",{staticClass:"var-slider__track"},[s("div",{staticClass:"var-slider__track-background",style:{background:t.trackColor,height:t.trackHeight+"px"}}),s("div",{staticClass:"var-slider__track-fill",style:t.getFillStyle})]),t._l(t.thumbList,function(r){return s("div",{key:r.enumValue,staticClass:"var-slider__thumb",style:{left:r.value+"%",zIndex:t.thumbsProps[r.enumValue].active?1:void 0},on:{touchstart:function(i){return t.start(i,r.enumValue)},touchmove:function(i){return t.move(i,r.enumValue)},touchend:function(i){return t.end(r.enumValue)},touchcancel:function(i){return t.end(r.enumValue)}}},[t._t("button",function(){return[s("div",{staticClass:"var-slider__thumb-block",style:{background:t.thumbColor,height:t.thumbSize+"px",width:t.thumbSize+"px"}}),s("div",{staticClass:"var-slider__thumb-ripple",class:[t.thumbsProps[r.enumValue].active?"var-slider__thumb-ripple-active":null],style:Object.assign({},{background:t.thumbColor},t.getRippleSize(r))}),s("div",{staticClass:"var-slider__thumb-label",class:[t.showLabel(r.enumValue)?"var-slider__thumb-label-active":null],style:{background:t.labelColor,color:t.labelTextColor,height:t.thumbSize===void 0?t.thumbSize:2*t.toNumber(t.thumbSize)+"px",width:t.thumbSize===void 0?t.thumbSize:2*t.toNumber(t.thumbSize)+"px"}},[s("span",[t._v(t._s(r.value))])])]},{currentValue:r.value})],2)})],2),s("var-form-details",{staticClass:"var-slider__form",attrs:{"error-message":t.errorMessage,"var-slider-cover":""}})],1)},W=[];const k=v({name:"VarSlider",mixins:[V,y("form",{parentKey:"form",childrenKey:"formItems"})],components:{VarFormDetails:S},props:C,data:()=>({maxWidth:0,isScroll:!1,thumbsProps:{first:{startPosition:0,currentLeft:0,active:!1,percentValue:0},second:{startPosition:0,currentLeft:0,active:!1,percentValue:0}}}),computed:{unitWidth(){return this.maxWidth/100*l(this.step)},thumbList(){let t=[{value:this.value,enumValue:"first"}];return this.range&&a(this.value)&&(t=[{value:this.value[0],enumValue:"first"},{value:this.value[1],enumValue:"second"}]),t},getFillStyle(){const{activeColor:t,range:e,value:s}=this,r=e&&a(s)?Math.abs(s[0]-s[1]):s,i=e&&a(s)?Math.min(s[0],s[1]):0;return{width:`${r}%`,left:`${i}%`,background:t}},isDisabled(){var t;return this.disabled||((t=this.form)==null?void 0:t.disabled)},isReadonly(){var t;return this.readonly||((t=this.form)==null?void 0:t.readonly)}},mounted(){!this.stepValidator()||!this.valueValidator()||(this.maxWidth=this.$refs.sliderEl.offsetWidth)},watch:{value(t){!this.stepValidator()||!this.valueValidator()||this.isScroll||this.setProps(t,l(this.step))},step(t){!this.stepValidator()||!this.valueValidator()||this.isScroll||this.setProps(this.value,l(t))},maxWidth(){this.setProps()}},methods:{toNumber:l,validate(){this._validate(this.rules,this.value)},validateWithTrigger(){this.$nextTick(()=>{const{rules:t,value:e}=this;this._validateWithTrigger(["onChange"],"onChange",t,e)})},getRippleSize(t){let e;return this.thumbSize!==void 0&&(e=this.thumbsProps[t.enumValue].active?`${3*l(this.thumbSize)}px`:"0px"),{height:e,width:e}},showLabel(t){return this.labelVisible==="always"?!0:this.labelVisible==="never"?!1:this.thumbsProps[t].active},setPercent(t,e){const{step:s,range:r,value:i,getListeners:d}=this,{onChange:u,onInput:n}=d();let o=[];const h=l(s),c=Math.round(t/this.unitWidth)*h,p=this.thumbsProps[e].percentValue;if(this.thumbsProps[e].percentValue=c/h,r&&a(i)&&(o=e==="first"?[c,i[1]]:[i[0],c]),p!==c){const f=r?o:c;u==null||u(f),n==null||n(f),this.validateWithTrigger()}},getType(t){if(!this.range)return"first";const e=this.thumbsProps.first.percentValue*this.unitWidth,s=this.thumbsProps.second.percentValue*this.unitWidth,r=Math.abs(t-e),i=Math.abs(t-s);return r<=i?"first":"second"},start(t,e){var s;this.maxWidth||(this.maxWidth=this.$refs.sliderEl.offsetWidth),!(this.isDisabled||this.isReadonly)&&((s=this.onStart)==null||s.call(this),this.isScroll=!0,this.thumbsProps[e].startPosition=t.touches[0].clientX)},move(t,e){if(this.isDisabled||this.isReadonly||!this.isScroll)return;let s=t.touches[0].clientX-this.thumbsProps[e].startPosition+this.thumbsProps[e].currentLeft;this.thumbsProps[e].active=!0,s<=0?s=0:s>=this.maxWidth&&(s=this.maxWidth),this.setPercent(s,e)},end(t){var o,h;const{isDisabled:e,isReadonly:s,range:r,value:i,getListeners:d}=this;if(e||s)return;let u=[];this.thumbsProps[t].currentLeft=this.thumbsProps[t].percentValue*this.unitWidth,this.thumbsProps[t].active=!1;const n=this.thumbsProps[t].percentValue;r&&a(i)&&(u=t==="first"?[n,i[1]]:[i[0],n]),(h=(o=d()).onEnd)==null||h.call(o,r?u:n),this.isScroll=!1},click(t){if(this.isDisabled||this.isReadonly||t.target.closest(".var-slider__thumb"))return;const e=t.clientX-g(t.currentTarget),s=this.getType(e);this.setPercent(e,s),this.end(s)},stepValidator(){const t=l(this.step);return isNaN(t)?(console.warn('[Varlet] Slider: type of prop "step" should be Number'),!1):t<1||t>100?(console.warn('[Varlet] Slider: "step" should be >= 0 and <= 100'),!1):parseInt(`${this.step}`,10)!==t?(console.warn('[Varlet] Slider: "step" should be an Integer'),!1):!0},valueValidator(){const{range:t,value:e}=this;return t&&!a(e)?(console.error('[Varlet] Slider: "value" should be an Array'),!1):!t&&a(e)?(console.error('[Varlet] Slider: "value" should be a Number'),!1):t&&a(e)&&e.length<2?(console.error('[Varlet] Slider: "value" should have two value'),!1):!0},setProps(t=this.value,e=l(this.step)){this.range&&a(t)?(this.thumbsProps.first.percentValue=t[0]/e,this.thumbsProps.first.currentLeft=this.thumbsProps.first.percentValue*this.unitWidth,this.thumbsProps.second.percentValue=t[1]/e,this.thumbsProps.second.currentLeft=this.thumbsProps.second.percentValue*this.unitWidth):_(t)&&(this.thumbsProps.first.currentLeft=t/e*this.unitWidth)},reset(){var e,s;const t=this.range?[0,0]:0;(s=(e=this.getListeners()).onInput)==null||s.call(e,t),this.resetValidation()}}}),b={};var N=P(k,z,W,!1,L,null,null,null);function L(t){for(let e in b)this[e]=b[e]}var m=function(){return N.exports}();m.install=function(t){t.component(m.name,m)};export{m as S};
